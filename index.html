<!DOCTYPE html>
<!-- now -->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cricket Overlay</title>
  <style>
    body {
      margin: 0;
      padding: 10px;
      font-family: Arial, sans-serif;
      font-size: 18px;
      color: #fff;
      background: rgba(0, 0, 0, 0.6);
    }
    .overlay {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .row {
      display: flex;
      justify-content: space-between;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      padding: 2px 0;
    }
    .label { font-weight: bold; margin-right: 10px; }
    .value { text-align: right; }
  </style>
</head>
<body>
  <div class="overlay">
    <div class="row"><span class="label">Player 1:</span> <span id="player1" class="value"></span></div>
    <div class="row"><span class="label">Player 2:</span> <span id="player2" class="value"></span></div>
    <div class="row"><span class="label">Ticker:</span> <span id="ticker" class="value"></span></div>
    <div class="row"><span class="label">CRR:</span> <span id="crr" class="value"></span></div>
    <div class="row"><span class="label">Bowler:</span> <span id="bowler" class="value"></span></div>
    <div class="row"><span class="label">This Over:</span> <span id="thisover" class="value"></span></div>
  </div>

  <script>
    async function fetchData() {
      try {
        const url = "https://docs.google.com/spreadsheets/d/1FUl5P--46Q7uzgUYEcmkVVdwzsRqTpad/gviz/tq?tqx=out:json&gid=658195036&t=" + Date.now();
        const res = await fetch(url, { cache: "no-store" });
        const text = await res.text();

        // Extract JSON safely
        const match = text.match(/google\.visualization\.Query\.setResponse\(([\s\S]*)\);/);
        if (!match) throw new Error("JSON not found in response");

        const json = JSON.parse(match[1]);
        const rows = json.table.rows;

        let data = {};
        rows.forEach(row => {
          const key = row.c[0]?.v;
          const value = row.c[1]?.v;
          if (key) data[key.trim()] = value || "";
        });

        console.log("Parsed Data:", data);

        document.getElementById("player1").innerText = data["Player 1"] || "";
        document.getElementById("player2").innerText = data["Player 2"] || "";
        document.getElementById("ticker").innerText = data["Ticker"] || "";
        document.getElementById("crr").innerText = data["CRR"] || "";
        document.getElementById("bowler").innerText = data["Bowler"] || "";
        document.getElementById("thisover").innerText = data["This Over"] || "";

      } catch (err) {
        console.error("Error fetching data:", err);
        document.getElementById("ticker").innerText = "âš  Error loading sheet";
      }
    }

    fetchData();
    setInterval(fetchData, 5000);
  </script>
</body>
</html>
