<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Cricket Overlay</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      font-size: 20px;
      font-weight: bold;
      color: white;
      background: rgba(0,0,0,0.6);
      padding: 20px;
    }
    .score-line {
      margin: 5px 0;
    }
    .key {
      color: #FFD700; /* gold for labels */
    }
    .value {
      color: #FFFFFF; /* white for values */
    }
  </style>
</head>
<body>
  <div id="overlay"></div>

  <script>
    async function fetchData() {
      const url = "https://docs.google.com/spreadsheets/d/1FUl5P--46Q7uzgUYEcmkVVdwzsRqTpad/gviz/tq?tqx=out:json&gid=658195036";

      try {
        const res = await fetch(url);
        const text = await res.text();

        // Clean Google response
        const json = JSON.parse(text.substr(47).slice(0, -2));

        const data = parseData(json);
        renderData(data);

      } catch (err) {
        console.error("Error fetching data:", err);
      }
    }

    function parseData(json) {
      let data = {};
      let cols = json.table.cols;
      let rows = json.table.rows;

      // ✅ Extract Player 1, Player 2, and Ticker from column labels
      if (cols.length > 1) {
        let values = cols[1].label.split(" ");

        data["Player 1"] = values[0] + " " + values[1];  
        data["Player 2"] = values[2] + " " + values[3];  
        data["Ticker"]  = values.slice(4).join(" ");      
      }

      // ✅ Extract CRR, Bowler, This Over, etc.
      rows.forEach(row => {
        if (row.c[0] && row.c[1]) {
          data[row.c[0].v] = row.c[1].v;
        }
      });

      return data;
    }

    function renderData(data) {
      const overlay = document.getElementById("overlay");
      overlay.innerHTML = "";

      for (let key in data) {
        const div = document.createElement("div");
        div.className = "score-line";
        div.innerHTML = `<span class="key">${key}:</span> <span class="value">${data[key]}</span>`;
        overlay.appendChild(div);
      }
    }

    // Refresh every 5 seconds
    setInterval(fetchData, 5000);
    fetchData();
  </script>
</body>
</html>
