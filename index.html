<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cricket Overlay</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: transparent;
      color: #fff;
    }

    /* Outer Overlay Box - Full Width, Top */
    .overlay {
      position: fixed;       /* ✅ always visible */
      top: 0;                /* ✅ at top of screen */
      left: 0;
      right: 0;
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 12px;
      padding: 20px 40px;
      background: rgba(0, 0, 0, 0.75);
      border-radius: 0;
      width: 100%;
      box-sizing: border-box;
      font-size: clamp(18px, 2.5vw, 24px);
      align-items: center;
      z-index: 9999; /* stay above everything */
    }

    .left {
      text-align: left;
      font-weight: 600;
    }
    .center {
      text-align: center;
      font-weight: 700;
    }
    .right {
      text-align: right;
      font-weight: 600;
    }

    /* This Over Box */
    .over-box {
      display: flex;
      align-items: center;
      background: linear-gradient(180deg, rgba(40,40,40,0.95), rgba(15,15,15,0.9));
      border: 1px solid rgba(255,255,255,0.15);
      border-radius: 18px;
      padding: 10px 16px;
      font-weight: 600;
      max-width: 550px;
      min-height: 60px;
    }

    .over-text {
      color: #ffeb3b;
      margin-right: 10px;
      font-size: clamp(16px, 2vw, 20px);
      flex-shrink: 0;
    }

    .balls-container {
      display: flex;
      gap: 6px;
      overflow-x: auto;
      white-space: nowrap;
      flex: 1;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    .balls-container::-webkit-scrollbar {
      display: none;
    }

    /* Ball styling + animation */
    @keyframes ballIn {
      from {
        opacity: 0;
        transform: translateY(10px) scale(0.8);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .ball {
      display: inline-block;
      min-width: 34px;
      height: 34px;
      line-height: 34px;
      border-radius: 50%;
      font-weight: 700;
      text-align: center;
      font-size: 18px;
      animation: ballIn 0.4s ease forwards;
    }

    /* Color codes */
    .dot { background: #777; color: #fff; }
    .run { background: #4caf50; color: #fff; }
    .four { background: #2196f3; color: #fff; }
    .six { background: #ff9800; color: #fff; }
    .wicket { background: #f44336; color: #fff; }
    .wide, .nb { background: #9c27b0; color: #fff; }
  </style>
</head>
<body>
  <div class="overlay">
    <div class="left" id="player1">Player 1</div>
    <div class="center" id="ticker">TICKER</div>
    <div class="right" id="bowler">Bowler</div>

    <div class="left" id="player2">Player 2</div>
    <div class="center" id="crr">CRR</div>
    <div class="right">
      <div class="over-box">
        <span class="over-text">This Over:</span>
        <div class="balls-container" id="balls"></div>
      </div>
    </div>
  </div>

  <script>
    const sheetURL = "https://docs.google.com/spreadsheets/d/1FUl5P--46Q7uzgUYEcmkVVdwzsRqTpad/gviz/tq?tqx=out:json&gid=658195036";

    function ballClass(b) {
      if (b === "W") return "wicket";
      if (b === "4") return "four";
      if (b === "6") return "six";
      if (b.toLowerCase() === "wd") return "wide";
      if (b.toLowerCase() === "nb") return "nb";
      if (b === "0") return "dot";
      return "run";
    }

    function formatBall(b) {
      return `<span class="ball ${ballClass(b)}">${b}</span>`;
    }

    async function updateOverlay() {
      try {
        const res = await fetch(sheetURL);
        const text = await res.text();
        const json = JSON.parse(text.substr(47).slice(0, -2));
        const rows = json.table.rows;

        const data = {};
        rows.forEach(row => {
          if (row.c[0] && row.c[1]) {
            const key = row.c[0].v.trim();
            const value = row.c[1].v;
            data[key] = value;
          }
        });

        document.getElementById("player1").textContent = data["Player 1"] || "";
        document.getElementById("player2").textContent = data["Player 2"] || "";
        document.getElementById("ticker").textContent = data["Ticker"] || "";
        document.getElementById("bowler").textContent = data["Bowler"] || "";
        document.getElementById("crr").textContent = data["CRR"] || "";

        const ballsEl = document.getElementById("balls");
        if (data["This Over"]) {
          const balls = data["This Over"].split(" ").filter(x => x.trim() !== "");
          ballsEl.innerHTML = balls.map(formatBall).join(" ");
          ballsEl.scrollTo({ left: ballsEl.scrollWidth, behavior: "smooth" });
        } else {
          ballsEl.innerHTML = "";
        }
      } catch (err) {
        console.error("Error fetching sheet:", err);
      }
    }

    setInterval(updateOverlay, 2000);
    updateOverlay();
  </script>
</body>
</html>
